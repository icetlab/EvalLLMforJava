diff --git a/clients/src/main/java/org/apache/kafka/common/utils/ByteUtils.java b/clients/src/main/java/org/apache/kafka/common/utils/ByteUtils.java
index 15868721da..c708282f9d 100644
--- a/clients/src/main/java/org/apache/kafka/common/utils/ByteUtils.java
+++ b/clients/src/main/java/org/apache/kafka/common/utils/ByteUtils.java
@@ -392,12 +392,17 @@ public final class ByteUtils {
      * @param value The signed value
      */
     public static int sizeOfUnsignedVarint(int value) {
-        int bytes = 1;
-        while ((value & 0xffffff80) != 0L) {
-            bytes += 1;
-            value >>>= 7;
+        // Branch-based implementation for better performance
+        if ((value & 0xffffff80) == 0) {
+            return 1;
+        } else if ((value & 0xffffc000) == 0) {
+            return 2;
+        } else if ((value & 0xffe00000) == 0) {
+            return 3;
+        } else if ((value & 0xf0000000) == 0) {
+            return 4;
         }
-        return bytes;
+        return 5;
     }
 
     /**
@@ -416,12 +421,27 @@ public final class ByteUtils {
      */
     public static int sizeOfVarlong(long value) {
         long v = (value << 1) ^ (value >> 63);
-        int bytes = 1;
-        while ((v & 0xffffffffffffff80L) != 0L) {
-            bytes += 1;
-            v >>>= 7;
+        // Branch-based implementation for better performance
+        if ((v & 0xffffffffffffff80L) == 0) {
+            return 1;
+        } else if ((v & 0xffffffffffffc000L) == 0) {
+            return 2;
+        } else if ((v & 0xffffffffffe00000L) == 0) {
+            return 3;
+        } else if ((v & 0xfffffffff0000000L) == 0) {
+            return 4;
+        } else if ((v & 0xfffffff800000000L) == 0) {
+            return 5;
+        } else if ((v & 0xfffffc0000000000L) == 0) {
+            return 6;
+        } else if ((v & 0xfffe000000000000L) == 0) {
+            return 7;
+        } else if ((v & 0xff00000000000000L) == 0) {
+            return 8;
+        } else if ((v & 0x8000000000000000L) == 0) {
+            return 9;
         }
-        return bytes;
+        return 10;
     }
 
     private static IllegalArgumentException illegalVarintException(int value) {
