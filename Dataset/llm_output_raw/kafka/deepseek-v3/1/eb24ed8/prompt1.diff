diff --git a/clients/src/main/java/org/apache/kafka/common/record/CompressionType.java b/clients/src/main/java/org/apache/kafka/common/record/CompressionType.java
index 352d12d834..79ae1792bb 100644
--- a/clients/src/main/java/org/apache/kafka/common/record/CompressionType.java
+++ b/clients/src/main/java/org/apache/kafka/common/record/CompressionType.java
@@ -166,36 +166,34 @@ public enum CompressionType {
      */
     public abstract InputStream wrapForInput(ByteBuffer buffer, byte messageVersion, BufferSupplier decompressionBufferSupplier);
 
+    private static final CompressionType[] ID_TO_TYPE = new CompressionType[] {
+        NONE, GZIP, SNAPPY, LZ4, ZSTD
+    };
+
     public static CompressionType forId(int id) {
-        switch (id) {
-            case 0:
-                return NONE;
-            case 1:
-                return GZIP;
-            case 2:
-                return SNAPPY;
-            case 3:
-                return LZ4;
-            case 4:
-                return ZSTD;
-            default:
-                throw new IllegalArgumentException("Unknown compression type id: " + id);
+        if (id >= 0 && id < ID_TO_TYPE.length) {
+            return ID_TO_TYPE[id];
         }
+        throw new IllegalArgumentException("Unknown compression type id: " + id);
+    }
+
+    private static final java.util.Map<String, CompressionType> NAME_TO_TYPE;
+    static {
+        java.util.Map<String, CompressionType> map = new java.util.HashMap<>();
+        map.put(NONE.name, NONE);
+        map.put(GZIP.name, GZIP);
+        map.put(SNAPPY.name, SNAPPY);
+        map.put(LZ4.name, LZ4);
+        map.put(ZSTD.name, ZSTD);
+        NAME_TO_TYPE = java.util.Collections.unmodifiableMap(map);
     }
 
     public static CompressionType forName(String name) {
-        if (NONE.name.equals(name))
-            return NONE;
-        else if (GZIP.name.equals(name))
-            return GZIP;
-        else if (SNAPPY.name.equals(name))
-            return SNAPPY;
-        else if (LZ4.name.equals(name))
-            return LZ4;
-        else if (ZSTD.name.equals(name))
-            return ZSTD;
-        else
+        CompressionType type = NAME_TO_TYPE.get(name);
+        if (type == null) {
             throw new IllegalArgumentException("Unknown compression name: " + name);
+        }
+        return type;
     }
 
     // We should only have a runtime dependency on compression algorithms in case the native libraries don't support
