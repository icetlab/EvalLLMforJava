diff --git a/storage/src/main/java/org/apache/kafka/storage/internals/log/ProducerStateManager.java b/storage/src/main/java/org/apache/kafka/storage/internals/log/ProducerStateManager.java
index 6bcafd2d60..dd30af10bf 100644
--- a/storage/src/main/java/org/apache/kafka/storage/internals/log/ProducerStateManager.java
+++ b/storage/src/main/java/org/apache/kafka/storage/internals/log/ProducerStateManager.java
@@ -177,6 +177,7 @@ public class ProducerStateManager {
     }
 
     private void removeProducerIds(List<Long> keys) {
+        // This method is kept for compatibility but should not be used in the optimized path
         producers.keySet().removeAll(keys);
         producerIdCount = producers.size();
     }
@@ -361,7 +362,9 @@ public class ProducerStateManager {
     }
 
     private boolean isProducerExpired(long currentTimeMs, ProducerStateEntry producerState) {
-        return !producerState.currentTxnFirstOffset().isPresent() && currentTimeMs - producerState.lastTimestamp() >= producerStateManagerConfig.producerIdExpirationMs();
+        // Inline the expiration check for better performance
+        return !producerState.currentTxnFirstOffset().isPresent() 
+            && currentTimeMs - producerState.lastTimestamp() >= producerStateManagerConfig.producerIdExpirationMs();
     }
 
     /**
@@ -369,17 +372,25 @@ public class ProducerStateManager {
      * Also expire any verification state entries that are lingering as unverified.
      */
     public void removeExpiredProducers(long currentTimeMs) {
-        List<Long> keys = producers.entrySet().stream()
-                .filter(entry -> isProducerExpired(currentTimeMs, entry.getValue()))
-                .map(Map.Entry::getKey)
-                .collect(Collectors.toList());
-        removeProducerIds(keys);
-
-        List<Long> verificationKeys = verificationStates.entrySet().stream()
-                .filter(entry -> currentTimeMs - entry.getValue().timestamp() >= producerStateManagerConfig.producerIdExpirationMs())
-                .map(Map.Entry::getKey)
-                .collect(Collectors.toList());
-        verificationKeys.forEach(verificationStates::remove);
+        // Use iterator for efficient removal without creating intermediate lists
+        Iterator<Map.Entry<Long, ProducerStateEntry>> producerIterator = producers.entrySet().iterator();
+        while (producerIterator.hasNext()) {
+            Map.Entry<Long, ProducerStateEntry> entry = producerIterator.next();
+            if (isProducerExpired(currentTimeMs, entry.getValue())) {
+                producerIterator.remove();
+            }
+        }
+        producerIdCount = producers.size();
+
+        // Similarly for verification states
+        Iterator<Map.Entry<Long, VerificationStateEntry>> verificationIterator = verificationStates.entrySet().iterator();
+        long expirationMs = producerStateManagerConfig.producerIdExpirationMs();
+        while (verificationIterator.hasNext()) {
+            Map.Entry<Long, VerificationStateEntry> entry = verificationIterator.next();
+            if (currentTimeMs - entry.getValue().timestamp() >= expirationMs) {
+                verificationIterator.remove();
+            }
+        }
     }
 
     /**
