diff --git a/clients/src/main/java/org/apache/kafka/common/utils/ByteUtils.java b/clients/src/main/java/org/apache/kafka/common/utils/ByteUtils.java
index 15868721da..825fe268b8 100644
--- a/clients/src/main/java/org/apache/kafka/common/utils/ByteUtils.java
+++ b/clients/src/main/java/org/apache/kafka/common/utils/ByteUtils.java
@@ -392,12 +392,11 @@ public final class ByteUtils {
      * @param value The signed value
      */
     public static int sizeOfUnsignedVarint(int value) {
-        int bytes = 1;
-        while ((value & 0xffffff80) != 0L) {
-            bytes += 1;
-            value >>>= 7;
-        }
-        return bytes;
+        // branchless computation using leading zeros
+        // bytes = ceil((32 - leadingZeros) / 7) = (38 - leadingZeros) / 7
+        // where leadingZeros is for value | 1 to handle value=0
+        int leadingZeros = Integer.numberOfLeadingZeros(value | 1);
+        return (38 - leadingZeros) / 7;
     }
 
     /**
@@ -416,12 +415,11 @@ public final class ByteUtils {
      */
     public static int sizeOfVarlong(long value) {
         long v = (value << 1) ^ (value >> 63);
-        int bytes = 1;
-        while ((v & 0xffffffffffffff80L) != 0L) {
-            bytes += 1;
-            v >>>= 7;
-        }
-        return bytes;
+        // branchless computation using leading zeros
+        // bytes = ceil((64 - leadingZeros) / 7) = (70 - leadingZeros) / 7
+        // where leadingZeros is for v | 1 to handle v=0
+        int leadingZeros = Long.numberOfLeadingZeros(v | 1L);
+        return (70 - leadingZeros) / 7;
     }
 
     private static IllegalArgumentException illegalVarintException(int value) {
