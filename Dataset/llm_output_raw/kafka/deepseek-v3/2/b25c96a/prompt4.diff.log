## Explanation

The performance issue is in the `removeExpiredProducers` method, which currently:
1. Streams through all producer entries to collect expired keys into a list
2. Then removes all those keys using `removeProducerIds(keys)` which calls `producers.keySet().removeAll(keys)`
3. Similarly for verification states

This is inefficient because:
- It creates intermediate collections (lists) for expired keys
- `removeAll` on `keySet()` iterates through the entire key set to match against the list of keys to remove
- With many producers, this O(n*m) operation becomes expensive

The fix is to use an iterator to remove expired entries in-place, which:
- Avoids creating intermediate collections
- Performs a single pass through the map
- Uses direct removal via iterator which is O(1) per removal

## Changes

```json
[
  {
    "filepath": "../kafka/storage/src/main/java/org/apache/kafka/storage/internals/log/ProducerStateManager.java",
    "search": "    public void removeExpiredProducers(long currentTimeMs) {\n        List<Long> keys = producers.entrySet().stream()\n                .filter(entry -> isProducerExpired(currentTimeMs, entry.getValue()))\n                .map(Map.Entry::getKey)\n                .collect(Collectors.toList());\n        removeProducerIds(keys);\n\n        List<Long> verificationKeys = verificationStates.entrySet().stream()\n                .filter(entry -> currentTimeMs - entry.getValue().timestamp() >= producerStateManagerConfig.producerIdExpirationMs())\n                .map(Map.Entry::getKey)\n                .collect(Collectors.toList());\n        verificationKeys.forEach(verificationStates::remove);\n    }",
    "replace": "    public void removeExpiredProducers(long currentTimeMs) {\n        // Use iterator for efficient in-place removal of expired producers\n        Iterator<Map.Entry<Long, ProducerStateEntry>> producerIter = producers.entrySet().iterator();\n        while (producerIter.hasNext()) {\n            Map.Entry<Long, ProducerStateEntry> entry = producerIter.next();\n            if (isProducerExpired(currentTimeMs, entry.getValue())) {\n                producerIter.remove();\n            }\n        }\n        producerIdCount = producers.size();\n\n        // Use iterator for efficient in-place removal of expired verification states\n        Iterator<Map.Entry<Long, VerificationStateEntry>> verificationIter = verificationStates.entrySet().iterator();\n        while (verificationIter.hasNext()) {\n            Map.Entry<Long, VerificationStateEntry> entry = verificationIter.next();\n            if (currentTimeMs - entry.getValue().timestamp() >= producerStateManagerConfig.producerIdExpirationMs()) {\n                verificationIter.remove();\n            }\n        }\n    }"
  },
  {
    "filepath": "../kafka/storage/src/main/java/org/apache/kafka/storage/internals/log/ProducerStateManager.java",
    "search": "    private void removeProducerIds(List<Long> keys) {\n        producers.keySet().removeAll(keys);\n        producerIdCount = producers.size();\n    }",
    "replace": "    private void removeProducerIds(List<Long> keys) {\n        // This method is kept for backward compatibility but should no longer be used\n        // by removeExpiredProducers. It may still be called from other code paths.\n        producers.keySet().removeAll(keys);\n        producerIdCount = producers.size();\n    }"
  }
]
```