**Improvement Intent:** Optimize `QueryStringDecoder` performance by reducing object allocations, improving string building efficiency, and optimizing hex decoding.

```json
[
  {
    "filepath": "../netty/codec-http/src/main/java/io/netty/handler/codec/http/QueryStringDecoder.java",
    "search": "    private static final int DEFAULT_MAX_PARAMS = 1024;\n\n    private final Charset charset;",
    "replace": "    private static final int DEFAULT_MAX_PARAMS = 1024;\n    private static final byte[] HEX_TABLE = new byte['f' + 1];\n    \n    static {\n        for (int i = 0; i < HEX_TABLE.length; i++) {\n            HEX_TABLE[i] = -1;\n        }\n        for (int i = '0'; i <= '9'; i++) {\n            HEX_TABLE[i] = (byte) (i - '0');\n        }\n        for (int i = 'A'; i <= 'F'; i++) {\n            HEX_TABLE[i] = (byte) (i - 'A' + 10);\n        }\n        for (int i = 'a'; i <= 'f'; i++) {\n            HEX_TABLE[i] = (byte) (i - 'a' + 10);\n        }\n    }\n\n    private final Charset charset;"
  },
  {
    "filepath": "../netty/codec-http/src/main/java/io/netty/handler/codec/http/QueryStringDecoder.java",
    "search": "        ByteBuffer byteBuf = ByteBuffer.allocate(decodedCapacity);\n        CharBuffer charBuf = CharBuffer.allocate(decodedCapacity);\n\n        StringBuilder strBuf = new StringBuilder(len);\n        strBuf.append(s, from, firstEscaped);",
    "replace": "        ByteBuffer byteBuf = ByteBuffer.allocate(decodedCapacity);\n        CharBuffer charBuf = CharBuffer.allocate(decodedCapacity);\n\n        StringBuilder strBuf = new StringBuilder(len);\n        if (firstEscaped > from) {\n            strBuf.append(s, from, firstEscaped);\n        }"
  },
  {
    "filepath": "../netty/codec-http/src/main/java/io/netty/handler/codec/http/QueryStringDecoder.java",
    "search": "            if (c != '%') {\n                strBuf.append(c != '+' || isPath? c : SPACE);\n                continue;\n            }\n\n            byteBuf.clear();\n            do {\n                if (i + 3 > toExcluded) {\n                    throw new IllegalArgumentException(\"unterminated escape sequence at index \" + i + \" of: \" + s);\n                }\n                byteBuf.put(decodeHexByte(s, i + 1));\n                i += 3;\n            } while (i < toExcluded && s.charAt(i) == '%');\n            i--;\n\n            byteBuf.flip();\n            charBuf.clear();\n            CoderResult result = decoder.reset().decode(byteBuf, charBuf, true);\n            try {\n                if (!result.isUnderflow()) {\n                    result.throwException();\n                }\n                result = decoder.flush(charBuf);\n                if (!result.isUnderflow()) {\n                    result.throwException();\n                }\n            } catch (CharacterCodingException ex) {\n                throw new IllegalStateException(ex);\n            }\n            strBuf.append(charBuf.flip());",
    "replace": "            if (c != '%') {\n                strBuf.append(c != '+' || isPath ? c : SPACE);\n                continue;\n            }\n\n            if (i + 3 > toExcluded) {\n                throw new IllegalArgumentException(\"unterminated escape sequence at index \" + i + \" of: \" + s);\n            }\n            \n            byte hex1 = HEX_TABLE[s.charAt(i + 1)];\n            byte hex2 = HEX_TABLE[s.charAt(i + 2)];\n            if (hex1 < 0 || hex2 < 0) {\n                throw new IllegalArgumentException(\"invalid hex byte '\" + s.substring(i + 1, i + 3) + \"' at index \" + (i + 1) + \" of: \" + s);\n            }\n            \n            byteBuf.clear();\n            byteBuf.put((byte) ((hex1 << 4) | hex2));\n            i += 2;\n            \n            while (i + 1 < toExcluded && s.charAt(i + 1) == '%') {\n                i += 1;\n                if (i + 3 > toExcluded) {\n                    throw new IllegalArgumentException(\"unterminated escape sequence at index \" + i + \" of: \" + s);\n                }\n                hex1 = HEX_TABLE[s.charAt(i + 1)];\n                hex2 = HEX_TABLE[s.charAt(i + 2)];\n                if (hex1 < 0 || hex2 < 0) {\n                    throw new IllegalArgumentException(\"invalid hex byte '\" + s.substring(i + 1, i + 3) + \"' at index \" + (i + 1) + \" of: \" + s);\n                }\n                byteBuf.put((byte) ((hex1 << 4) | hex2));\n                i += 2;\n            }\n            \n            byteBuf.flip();\n            charBuf.clear();\n            CoderResult result = decoder.reset().decode(byteBuf, charBuf, true);\n            try {\n                if (!result.isUnderflow()) {\n                    result.throwException();\n                }\n                result = decoder.flush(charBuf);\n                if (!result.isUnderflow()) {\n                    result.throwException();\n                }\n            } catch (CharacterCodingException ex) {\n                throw new IllegalStateException(ex);\n            }\n            strBuf.append(charBuf.flip());"
  },
  {
    "filepath": "../netty/codec-http/src/main/java/io/netty/handler/codec/http/QueryStringDecoder.java",
    "search": "        if (valueStart <= nameStart) {\n            valueStart = valueEnd + 1;\n        }\n        String name = decodeComponent(s, nameStart, valueStart - 1, charset, false);\n        String value = decodeComponent(s, valueStart, valueEnd, charset, false);\n        List<String> values = params.get(name);\n        if (values == null) {\n            values = new ArrayList<String>(1);  // Often there's only 1 value.\n            params.put(name, values);\n        }\n        values.add(value);\n        return true;",
    "replace": "        if (valueStart <= nameStart) {\n            valueStart = valueEnd + 1;\n        }\n        String name = decodeComponent(s, nameStart, valueStart - 1, charset, false);\n        String value = decodeComponent(s, valueStart, valueEnd, charset, false);\n        List<String> values = params.get(name);\n        if (values == null) {\n            values = new ArrayList<String>(1);  // Often there's only 1 value.\n            params.put(name, values);\n        }\n        values.add(value);\n        return true;"
  },
  {
    "filepath": "../netty/codec-http/src/main/java/io/netty/handler/codec/http/QueryStringDecoder.java",
    "search": "    private static int findPathEndIndex(String uri) {\n        int len = uri.length();\n        for (int i = 0; i < len; i++) {\n            char c = uri.charAt(i);\n            if (c == '?' || c == '#') {\n                return i;\n            }\n        }\n        return len;\n    }",
    "replace": "    private static int findPathEndIndex(String uri) {\n        int len = uri.length();\n        for (int i = 0; i < len; i++) {\n            char c = uri.charAt(i);\n            if (c == '?' || c == '#') {\n                return i;\n            }\n        }\n        return len;\n    }\n    \n    private static byte decodeHexByte(String s, int pos) {\n        int hi = charToHex(s.charAt(pos));\n        int lo = charToHex(s.charAt(pos + 1));\n        if (hi == -1 || lo == -1) {\n            throw new IllegalArgumentException(\"invalid hex byte '\" + s.substring(pos, pos + 2) + \"' at index \" + pos + \" of '\" + s + \"'\");\n        }\n        return (byte) ((hi << 4) | lo);\n    }\n    \n    private static int charToHex(char ch) {\n        return ch < HEX_TABLE.length ? HEX_TABLE[ch] : -1;\n    }"
  }
]
```