diff --git a/buffer/src/main/java/io/netty/buffer/AbstractReferenceCountedByteBuf.java b/buffer/src/main/java/io/netty/buffer/AbstractReferenceCountedByteBuf.java
index e657ad86f8..d4c8e9f907 100644
--- a/buffer/src/main/java/io/netty/buffer/AbstractReferenceCountedByteBuf.java
+++ b/buffer/src/main/java/io/netty/buffer/AbstractReferenceCountedByteBuf.java
@@ -62,10 +62,12 @@ public abstract class AbstractReferenceCountedByteBuf extends AbstractByteBuf {
     private ByteBuf retain0(int increment) {
         for (;;) {
             int refCnt = this.refCnt;
-            final int nextCnt = refCnt + increment;
-
-            // Ensure we not resurrect (which means the refCnt was 0) and also that we encountered an overflow.
-            if (nextCnt <= increment) {
+            if (refCnt == 0) {
+                throw new IllegalReferenceCountException(refCnt, increment);
+            }
+            int nextCnt = refCnt + increment;
+            // Detect overflow
+            if (nextCnt < refCnt) {
                 throw new IllegalReferenceCountException(refCnt, increment);
             }
             if (refCntUpdater.compareAndSet(this, refCnt, nextCnt)) {
diff --git a/common/src/main/java/io/netty/util/AbstractReferenceCounted.java b/common/src/main/java/io/netty/util/AbstractReferenceCounted.java
index 493bcc1872..68ca7f9ad3 100644
--- a/common/src/main/java/io/netty/util/AbstractReferenceCounted.java
+++ b/common/src/main/java/io/netty/util/AbstractReferenceCounted.java
@@ -54,10 +54,12 @@ public abstract class AbstractReferenceCounted implements ReferenceCounted {
     private ReferenceCounted retain0(int increment) {
         for (;;) {
             int refCnt = this.refCnt;
-            final int nextCnt = refCnt + increment;
-
-            // Ensure we not resurrect (which means the refCnt was 0) and also that we encountered an overflow.
-            if (nextCnt <= increment) {
+            if (refCnt == 0) {
+                throw new IllegalReferenceCountException(refCnt, increment);
+            }
+            int nextCnt = refCnt + increment;
+            // Detect overflow
+            if (nextCnt < refCnt) {
                 throw new IllegalReferenceCountException(refCnt, increment);
             }
             if (refCntUpdater.compareAndSet(this, refCnt, nextCnt)) {
