diff --git a/RoaringBitmap/src/main/java/org/roaringbitmap/RoaringBitmap.java b/RoaringBitmap/src/main/java/org/roaringbitmap/RoaringBitmap.java
index 9ae064da..9fbbf64a 100644
--- a/RoaringBitmap/src/main/java/org/roaringbitmap/RoaringBitmap.java
+++ b/RoaringBitmap/src/main/java/org/roaringbitmap/RoaringBitmap.java
@@ -92,8 +92,11 @@ public class RoaringBitmap implements Cloneable, Serializable, Iterable<Integer>
 
     private void nextContainer() {
       if (pos < RoaringBitmap.this.highLowContainer.size()) {
-        iter = RoaringBitmap.this.highLowContainer.getContainerAtIndex(pos).getCharIterator();
-        hs = RoaringBitmap.this.highLowContainer.getKeyAtIndex(pos) << 16;
+        // Cache the container and key to avoid multiple method calls
+        Container container = RoaringBitmap.this.highLowContainer.getContainerAtIndex(pos);
+        char key = RoaringBitmap.this.highLowContainer.getKeyAtIndex(pos);
+        iter = container.getCharIterator();
+        hs = key << 16;
       }
     }
 
@@ -1111,8 +1114,11 @@ public class RoaringBitmap implements Cloneable, Serializable, Iterable<Integer>
     final char hb = Util.highbits(x);
     final int i = highLowContainer.getIndex(hb);
     if (i >= 0) {
-      highLowContainer.setContainerAtIndex(i,
-          highLowContainer.getContainerAtIndex(i).add(Util.lowbits(x)));
+      Container c = highLowContainer.getContainerAtIndex(i);
+      Container newCont = c.add(Util.lowbits(x));
+      if (newCont != c) {
+        highLowContainer.setContainerAtIndex(i, newCont);
+      }
     } else {
       final ArrayContainer newac = new ArrayContainer();
       highLowContainer.insertNewKeyValueAt(-i - 1, hb, newac.add(Util.lowbits(x)));
@@ -1564,16 +1570,17 @@ public class RoaringBitmap implements Cloneable, Serializable, Iterable<Integer>
       // we need to keep the newContainer if a switch between containers type
       // occur, in order to get the new cardinality
       Container newCont = c.add(Util.lowbits(x));
-      highLowContainer.setContainerAtIndex(i, newCont);
-      if (newCont.getCardinality() > oldCard) {
-        return true;
+      // Only update if container actually changed (different reference or type changed)
+      if (newCont != c) {
+        highLowContainer.setContainerAtIndex(i, newCont);
       }
+      // Check if cardinality increased - add() returns same container when element already exists
+      return newCont != c || newCont.getCardinality() > oldCard;
     } else {
       final ArrayContainer newac = new ArrayContainer();
       highLowContainer.insertNewKeyValueAt(-i - 1, hb, newac.add(Util.lowbits(x)));
       return true;
     }
-    return false;
   }
 
   /**
diff --git a/RoaringBitmap/src/main/java/org/roaringbitmap/buffer/MutableRoaringBitmap.java b/RoaringBitmap/src/main/java/org/roaringbitmap/buffer/MutableRoaringBitmap.java
index fb9e35b4..e4facc0b 100644
--- a/RoaringBitmap/src/main/java/org/roaringbitmap/buffer/MutableRoaringBitmap.java
+++ b/RoaringBitmap/src/main/java/org/roaringbitmap/buffer/MutableRoaringBitmap.java
@@ -783,8 +783,11 @@ public class MutableRoaringBitmap extends ImmutableRoaringBitmap
     final char hb = BufferUtil.highbits(x);
     final int i = highLowContainer.getIndex(hb);
     if (i >= 0) {
-      getMappeableRoaringArray().setContainerAtIndex(i,
-          highLowContainer.getContainerAtIndex(i).add(BufferUtil.lowbits(x)));
+      MappeableContainer c = highLowContainer.getContainerAtIndex(i);
+      MappeableContainer newCont = c.add(BufferUtil.lowbits(x));
+      if (newCont != c) {
+        getMappeableRoaringArray().setContainerAtIndex(i, newCont);
+      }
     } else {
       final MappeableArrayContainer newac = new MappeableArrayContainer();
       getMappeableRoaringArray().insertNewKeyValueAt(-i - 1, hb, newac.add(BufferUtil.lowbits(x)));
@@ -1023,9 +1026,13 @@ public class MutableRoaringBitmap extends ImmutableRoaringBitmap
     if (i >= 0) {
       MappeableContainer C = highLowContainer.getContainerAtIndex(i);
       int oldcard = C.getCardinality();
-      C = C.add(BufferUtil.lowbits(x));
-      getMappeableRoaringArray().setContainerAtIndex(i, C);
-      return C.getCardinality() > oldcard;
+      MappeableContainer newCont = C.add(BufferUtil.lowbits(x));
+      // Only update if container actually changed (different reference or type changed)
+      if (newCont != C) {
+        getMappeableRoaringArray().setContainerAtIndex(i, newCont);
+      }
+      // Check if cardinality increased - add() returns same container when element already exists
+      return newCont != C || newCont.getCardinality() > oldcard;
     } else {
       final MappeableArrayContainer newac = new MappeableArrayContainer();
       getMappeableRoaringArray().insertNewKeyValueAt(-i - 1, hb, newac.add(BufferUtil.lowbits(x)));
