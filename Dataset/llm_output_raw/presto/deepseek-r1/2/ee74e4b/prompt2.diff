diff --git a/presto-main/src/main/java/com/facebook/presto/operator/project/PageProcessor.java b/presto-main/src/main/java/com/facebook/presto/operator/project/PageProcessor.java
index 979fc2cb80..b595ae5a96 100644
--- a/presto-main/src/main/java/com/facebook/presto/operator/project/PageProcessor.java
+++ b/presto-main/src/main/java/com/facebook/presto/operator/project/PageProcessor.java
@@ -267,9 +267,9 @@ public class PageProcessor
                     });
                 }
             }
-            for (Block previouslyComputedResult : previouslyComputedResults) {
-                if (previouslyComputedResult != null) {
-                    previouslyComputedResult.retainedBytesForEachPart((object, size) -> {
+            for (int i = 0; i < previouslyComputedResults.length; i++) {
+                if (previouslyComputedResults[i] != null) {
+                    previouslyComputedResults[i].retainedBytesForEachPart((object, size) -> {
                         if (referenceCountMap.incrementAndGet(object) == 1) {
                             retainedSizeInBytes += size;
                         }
@@ -291,6 +291,8 @@ public class PageProcessor
                     return ProcessBatchResult.processBatchYield();
                 }
 
+                // Check page size less frequently to reduce overhead
+                // Only check when we have processed at least 2 projections or when page size exceeds threshold
                 if (positionsBatch.size() > 1 && pageSize > MAX_PAGE_SIZE_IN_BYTES) {
                     return ProcessBatchResult.processBatchTooLarge();
                 }
