diff --git a/presto-main/src/main/java/com/facebook/presto/tdigest/TDigest.java b/presto-main/src/main/java/com/facebook/presto/tdigest/TDigest.java
index ce0ca747f2..c9b87dee73 100644
--- a/presto-main/src/main/java/com/facebook/presto/tdigest/TDigest.java
+++ b/presto-main/src/main/java/com/facebook/presto/tdigest/TDigest.java
@@ -195,7 +195,8 @@ public class TDigest
         checkArgument(!Double.isNaN(x), "Cannot add NaN to t-digest");
         checkArgument(w > 0L, "weight must be > 0");
 
-        if (tempUsed >= tempWeight.length - activeCentroids - 1) {
+        // Ensure there's enough space in temp arrays for the merge operation
+        if (tempUsed >= tempWeight.length - activeCentroids) {
             mergeNewValues();
         }
         int where = tempUsed++;
