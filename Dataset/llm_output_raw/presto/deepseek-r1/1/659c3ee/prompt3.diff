diff --git a/presto-orc/src/main/java/com/facebook/presto/orc/reader/ByteSelectiveStreamReader.java b/presto-orc/src/main/java/com/facebook/presto/orc/reader/ByteSelectiveStreamReader.java
index 93aeb97e76..5d870f7ff9 100644
--- a/presto-orc/src/main/java/com/facebook/presto/orc/reader/ByteSelectiveStreamReader.java
+++ b/presto-orc/src/main/java/com/facebook/presto/orc/reader/ByteSelectiveStreamReader.java
@@ -156,7 +156,7 @@ public class ByteSelectiveStreamReader
             skip(offset - readOffset);
         }
 
-        int streamPosition = 0;
+        int streamPosition;
         if (dataStream == null && presentStream != null) {
             streamPosition = readAllNulls(positions, positionCount);
         }
@@ -184,7 +184,15 @@ public class ByteSelectiveStreamReader
             }
 
             if (presentStream != null && !presentStream.nextBit()) {
-                if ((nonDeterministicFilter && filter.testNull()) || nullsAllowed) {
+                if (nonDeterministicFilter) {
+                    if (filter.testNull()) {
+                        if (outputRequired) {
+                            nulls[outputPositionCount] = true;
+                        }
+                        outputPositions[outputPositionCount] = position;
+                        outputPositionCount++;
+                    }
+                } else if (nullsAllowed) {
                     if (outputRequired) {
                         nulls[outputPositionCount] = true;
                     }
@@ -265,6 +273,7 @@ public class ByteSelectiveStreamReader
         }
 
         int streamPosition = 0;
+        boolean hasPresentStream = presentStream != null;
         for (int i = 0; i < positionCount; i++) {
             int position = positions[i];
             if (position > streamPosition) {
@@ -272,12 +281,12 @@ public class ByteSelectiveStreamReader
                 streamPosition = position;
             }
 
-            if (presentStream != null && !presentStream.nextBit()) {
+            if (hasPresentStream && !presentStream.nextBit()) {
                 nulls[i] = true;
             }
             else {
                 values[i] = dataStream.next();
-                if (presentStream != null) {
+                if (hasPresentStream) {
                     nulls[i] = false;
                 }
             }
@@ -294,8 +303,12 @@ public class ByteSelectiveStreamReader
             presentStream.skip(items);
         }
         else if (presentStream != null) {
-            int dataToSkip = presentStream.countBitsSet(items);
-            dataStream.skip(dataToSkip);
+            if (items > 0) {
+                int dataToSkip = presentStream.countBitsSet(items);
+                if (dataToSkip > 0) {
+                    dataStream.skip(dataToSkip);
+                }
+            }
         }
         else {
             dataStream.skip(items);
@@ -304,10 +317,12 @@ public class ByteSelectiveStreamReader
 
     private void ensureValuesCapacity(int capacity, boolean recordNulls)
     {
-        values = ensureCapacity(values, capacity);
+        if (values == null || values.length < capacity) {
+            values = new byte[capacity];
+        }
 
-        if (recordNulls) {
-            nulls = ensureCapacity(nulls, capacity);
+        if (recordNulls && (nulls == null || nulls.length < capacity)) {
+            nulls = new boolean[capacity];
         }
     }
 
