diff --git a/presto-orc/src/main/java/com/facebook/presto/orc/reader/SliceDirectSelectiveStreamReader.java b/presto-orc/src/main/java/com/facebook/presto/orc/reader/SliceDirectSelectiveStreamReader.java
index 79b56c6971..ddfe67cf35 100644
--- a/presto-orc/src/main/java/com/facebook/presto/orc/reader/SliceDirectSelectiveStreamReader.java
+++ b/presto-orc/src/main/java/com/facebook/presto/orc/reader/SliceDirectSelectiveStreamReader.java
@@ -655,21 +655,31 @@ public class SliceDirectSelectiveStreamReader
                 }
             }
             else {
+                // Optimized: Only process lengths for positions we actually need
                 int positionIndex = 0;
                 int lengthIndex = 0;
-                for (int i = 0; i < totalPositions; i++) {
-                    boolean isNotNull = nullCount == 0 || !isNullVector[i];
-                    if (i == positions[positionIndex]) {
-                        if (isNotNull) {
-                            totalLength += lengthVector[lengthIndex];
-                            maxLength = Math.max(maxLength, lengthVector[lengthIndex]);
+                int i = 0;
+                
+                while (positionIndex < positionCount) {
+                    int currentPosition = positions[positionIndex];
+                    
+                    // Skip positions before the current one we need
+                    while (i < currentPosition) {
+                        if (nullCount == 0 || !isNullVector[i]) {
                             lengthIndex++;
                         }
-                        positionIndex++;
+                        i++;
                     }
-                    else if (isNotNull) {
+                    
+                    // Now we're at a position we need
+                    if (nullCount == 0 || !isNullVector[currentPosition]) {
+                        totalLength += lengthVector[lengthIndex];
+                        maxLength = Math.max(maxLength, lengthVector[lengthIndex]);
                         lengthIndex++;
                     }
+                    
+                    positionIndex++;
+                    i++;
                 }
             }
 
