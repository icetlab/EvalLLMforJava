The performance issue is to improve `HashGenerator.getPartition` performance. The current implementation uses modulo operation (`%`) which can be slow for power-of-two partition counts. We can optimize by using bitwise AND when partitionCount is a power of two, which is much faster. However, since partitionCount might not always be a power of two, we need to detect that condition and use the appropriate method.

Looking at the code, `getPartition` is a default method in the `HashGenerator` interface. We can optimize it by:
1. Checking if partitionCount is a power of two
2. If yes, use bitwise AND: `rawHash & (partitionCount - 1)`
3. If no, use modulo operation as before

This optimization is safe because:
- `rawHash` is already non-negative (sign bit cleared)
- Bitwise AND with `(partitionCount - 1)` is equivalent to modulo for power-of-two numbers
- The checkState validation remains valid

However, we need to be careful because partitionCount might be passed from various callers. The optimization should be transparent and maintain backward compatibility.

```json
[
  {
    "filepath": "../presto/presto-main/src/main/java/com/facebook/presto/operator/HashGenerator.java",
    "search": "    default int getPartition(int partitionCount, int position, Page page)\n    {\n        long rawHash = hashPosition(position, page);\n\n        // clear the sign bit\n        rawHash &= 0x7fff_ffff_ffff_ffffL;\n\n        int partition = (int) (rawHash % partitionCount);\n\n        checkState(partition >= 0 && partition < partitionCount);\n        return partition;\n    }",
    "replace": "    default int getPartition(int partitionCount, int position, Page page)\n    {\n        long rawHash = hashPosition(position, page);\n\n        // clear the sign bit\n        rawHash &= 0x7fff_ffff_ffff_ffffL;\n\n        int partition;\n        if ((partitionCount & (partitionCount - 1)) == 0) {\n            // partitionCount is a power of two, use bitwise AND which is faster\n            partition = (int) (rawHash & (partitionCount - 1));\n        }\n        else {\n            partition = (int) (rawHash % partitionCount);\n        }\n\n        checkState(partition >= 0 && partition < partitionCount);\n        return partition;\n    }"
  }
]
```