Looking at the test failure, the issue is that `blockBuilders` is an `ImmutableList` (created via `toImmutableList()` in the constructor), and we're trying to modify it with `set()` which throws `UnsupportedOperationException`. The performance improvement I suggested inadvertently introduced a bug by trying to modify an immutable list.

The original code was creating a new immutable list each time, which is inefficient but correct. We need to maintain correctness while improving performance. Instead of modifying the immutable list, we should:
1. Use a mutable list from the start, or
2. Create a new list efficiently without streams

Here's the fix: change the constructor to create a mutable list and update the project method to reset builders in-place.

```json
[
  {
    "filepath": "../presto/presto-main/src/main/java/com/facebook/presto/operator/project/GeneratedPageProjection.java",
    "search": "import com.google.common.collect.ImmutableList;\n\nimport java.lang.invoke.MethodHandle;\nimport java.util.List;\n\nimport static com.google.common.base.MoreObjects.toStringHelper;\nimport static com.google.common.collect.ImmutableList.toImmutableList;\nimport static java.util.Objects.requireNonNull;",
    "replace": "import com.google.common.collect.ImmutableList;\n\nimport java.lang.invoke.MethodHandle;\nimport java.util.ArrayList;\nimport java.util.List;\n\nimport static com.google.common.base.MoreObjects.toStringHelper;\nimport static java.util.Objects.requireNonNull;"
  },
  {
    "filepath": "../presto/presto-main/src/main/java/com/facebook/presto/operator/project/GeneratedPageProjection.java",
    "search": "    public GeneratedPageProjection(List<RowExpression> projections, boolean isDeterministic, InputChannels inputChannels, MethodHandle pageProjectionWorkFactory)\n    {\n        this.projections = ImmutableList.copyOf(requireNonNull(projections, \"projections is null\"));\n        this.isDeterministic = isDeterministic;\n        this.inputChannels = requireNonNull(inputChannels, \"inputChannels is null\");\n        this.pageProjectionWorkFactory = requireNonNull(pageProjectionWorkFactory, \"pageProjectionWorkFactory is null\");\n        this.blockBuilders = projections.stream().map(RowExpression::getType).map(type -> type.createBlockBuilder(null, 1)).collect(toImmutableList());\n    }",
    "replace": "    public GeneratedPageProjection(List<RowExpression> projections, boolean isDeterministic, InputChannels inputChannels, MethodHandle pageProjectionWorkFactory)\n    {\n        this.projections = ImmutableList.copyOf(requireNonNull(projections, \"projections is null\"));\n        this.isDeterministic = isDeterministic;\n        this.inputChannels = requireNonNull(inputChannels, \"inputChannels is null\");\n        this.pageProjectionWorkFactory = requireNonNull(pageProjectionWorkFactory, \"pageProjectionWorkFactory is null\");\n        this.blockBuilders = new ArrayList<>(projections.size());\n        for (RowExpression projection : projections) {\n            blockBuilders.add(projection.getType().createBlockBuilder(null, 1));\n        }\n    }"
  },
  {
    "filepath": "../presto/presto-main/src/main/java/com/facebook/presto/operator/project/GeneratedPageProjection.java",
    "search": "    @Override\n    public Work<List<Block>> project(SqlFunctionProperties properties, DriverYieldSignal yieldSignal, Page page, SelectedPositions selectedPositions)\n    {\n        blockBuilders = blockBuilders.stream().map(blockBuilder -> blockBuilder.newBlockBuilderLike(null)).collect(toImmutableList());\n        try {\n            return (Work<List<Block>>) pageProjectionWorkFactory.invoke(blockBuilders, properties, page, selectedPositions);\n        }\n        catch (Throwable e) {\n            throw new RuntimeException(e);\n        }\n    }",
    "replace": "    @Override\n    public Work<List<Block>> project(SqlFunctionProperties properties, DriverYieldSignal yieldSignal, Page page, SelectedPositions selectedPositions)\n    {\n        // Reset block builders for reuse\n        for (int i = 0; i < blockBuilders.size(); i++) {\n            blockBuilders.set(i, blockBuilders.get(i).newBlockBuilderLike(null));\n        }\n        try {\n            return (Work<List<Block>>) pageProjectionWorkFactory.invoke(blockBuilders, properties, page, selectedPositions);\n        }\n        catch (Throwable e) {\n            throw new RuntimeException(e);\n        }\n    }"
  }
]
```