diff --git a/presto-orc/src/main/java/com/facebook/presto/orc/reader/ByteSelectiveStreamReader.java b/presto-orc/src/main/java/com/facebook/presto/orc/reader/ByteSelectiveStreamReader.java
index da887a9ba3..67de56afb9 100644
--- a/presto-orc/src/main/java/com/facebook/presto/orc/reader/ByteSelectiveStreamReader.java
+++ b/presto-orc/src/main/java/com/facebook/presto/orc/reader/ByteSelectiveStreamReader.java
@@ -176,7 +176,8 @@ public class ByteSelectiveStreamReader
     {
         int streamPosition = 0;
         outputPositionCount = 0;
-        for (int i = 0; i < positionCount; i++) {
+        int i = 0;
+        while (i < positionCount) {
             int position = positions[i];
             if (position > streamPosition) {
                 skip(position - streamPosition);
@@ -206,6 +207,7 @@ public class ByteSelectiveStreamReader
                 }
             }
             streamPosition++;
+            i++;
 
             if (filter != null) {
                 outputPositionCount -= filter.getPrecedingPositionsToFail();
@@ -213,10 +215,11 @@ public class ByteSelectiveStreamReader
                 if (succeedingPositionsToFail > 0) {
                     int positionsToSkip = 0;
                     for (int j = 0; j < succeedingPositionsToFail; j++) {
-                        i++;
+                        if (i >= positionCount) break;
                         int nextPosition = positions[i];
                         positionsToSkip += 1 + nextPosition - streamPosition;
                         streamPosition = nextPosition + 1;
+                        i++;
                     }
                     skip(positionsToSkip);
                 }
@@ -258,7 +261,8 @@ public class ByteSelectiveStreamReader
     {
         // filter == null implies outputRequired == true
         int streamPosition = 0;
-        for (int i = 0; i < positionCount; i++) {
+        int i = 0;
+        while (i < positionCount) {
             int position = positions[i];
             if (position > streamPosition) {
                 skip(position - streamPosition);
@@ -275,6 +279,7 @@ public class ByteSelectiveStreamReader
                 }
             }
             streamPosition++;
+            i++;
         }
         outputPositionCount = positionCount;
         return streamPosition;
@@ -396,8 +401,10 @@ public class ByteSelectiveStreamReader
     {
         int positionIndex = 0;
         int nextPosition = positions[positionIndex];
-        for (int i = 0; i < outputPositionCount; i++) {
+        int i = 0;
+        while (i < outputPositionCount && positionIndex < positionCount) {
             if (outputPositions[i] < nextPosition) {
+                i++;
                 continue;
             }
 
@@ -414,6 +421,7 @@ public class ByteSelectiveStreamReader
                 break;
             }
             nextPosition = positions[positionIndex];
+            i++;
         }
 
         outputPositionCount = positionCount;
diff --git a/presto-orc/src/main/java/com/facebook/presto/orc/stream/ByteInputStream.java b/presto-orc/src/main/java/com/facebook/presto/orc/stream/ByteInputStream.java
index 21edc123eb..2bbf51105e 100644
--- a/presto-orc/src/main/java/com/facebook/presto/orc/stream/ByteInputStream.java
+++ b/presto-orc/src/main/java/com/facebook/presto/orc/stream/ByteInputStream.java
@@ -100,13 +100,18 @@ public class ByteInputStream
     public void skip(long items)
             throws IOException
     {
-        while (items > 0) {
+        long remaining = items;
+        while (remaining > 0) {
             if (offset == length) {
                 readNextBlock();
             }
-            long consume = Math.min(items, length - offset);
-            offset += consume;
-            items -= consume;
+            long available = length - offset;
+            if (remaining <= available) {
+                offset += remaining;
+                break;
+            }
+            offset = length;
+            remaining -= available;
         }
     }
 
@@ -122,8 +127,12 @@ public class ByteInputStream
     public void nextVector(Type type, long items, BlockBuilder builder)
             throws IOException
     {
-        for (int i = 0; i < items; i++) {
-            type.writeLong(builder, next());
+        int itemCount = (int) items;
+        for (int i = 0; i < itemCount; i++) {
+            if (offset == length) {
+                readNextBlock();
+            }
+            type.writeLong(builder, buffer[offset++]);
         }
     }
 }
