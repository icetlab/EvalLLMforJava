diff --git a/presto-main/src/main/java/com/facebook/presto/operator/scalar/MapConcatFunction.java b/presto-main/src/main/java/com/facebook/presto/operator/scalar/MapConcatFunction.java
index 24e83bddde..92e67b9683 100644
--- a/presto-main/src/main/java/com/facebook/presto/operator/scalar/MapConcatFunction.java
+++ b/presto-main/src/main/java/com/facebook/presto/operator/scalar/MapConcatFunction.java
@@ -40,8 +40,15 @@ public final class MapConcatFunction
             @SqlType("map(K,V)") Block leftMap,
             @SqlType("map(K,V)") Block rightMap)
     {
-        TypedSet typedSet = new TypedSet(keyType, rightMap.getPositionCount());
-        BlockBuilder blockBuilder = new InterleavedBlockBuilder(ImmutableList.of(keyType, valueType), new BlockBuilderStatus(), leftMap.getPositionCount() + rightMap.getPositionCount());
+        int rightKeyCount = rightMap.getPositionCount() / 2;
+        int leftKeyCount = leftMap.getPositionCount() / 2;
+
+        TypedSet typedSet = new TypedSet(keyType, rightKeyCount);
+        BlockBuilder blockBuilder = new InterleavedBlockBuilder(
+                ImmutableList.of(keyType, valueType),
+                new BlockBuilderStatus(),
+                (rightKeyCount + leftKeyCount) * 2);
+
         for (int i = 0; i < rightMap.getPositionCount(); i += 2) {
             typedSet.add(rightMap, i);
             keyType.appendTo(rightMap, i, blockBuilder);
