diff --git a/presto-main/src/main/java/com/facebook/presto/operator/WindowOperator.java b/presto-main/src/main/java/com/facebook/presto/operator/WindowOperator.java
index 6813ba04fa..a4d49a182e 100644
--- a/presto-main/src/main/java/com/facebook/presto/operator/WindowOperator.java
+++ b/presto-main/src/main/java/com/facebook/presto/operator/WindowOperator.java
@@ -923,6 +923,21 @@ public class WindowOperator
         checkArgument(startPosition >= 0, "startPosition must be greater or equal than zero: %s", startPosition);
         checkArgument(startPosition < endPosition, "startPosition (%s) must be less than endPosition (%s)", startPosition, endPosition);
 
+        // If the range is small, use linear scan for better performance
+        if (endPosition - startPosition <= 16) {
+            for (int i = startPosition + 1; i < endPosition; i++) {
+                if (!comparator.test(startPosition, i)) {
+                    return i;
+                }
+            }
+            return endPosition;
+        }
+
+        // Check if the entire range is one group
+        if (comparator.test(startPosition, endPosition - 1)) {
+            return endPosition;
+        }
+
         int left = startPosition;
         int right = endPosition;
 
