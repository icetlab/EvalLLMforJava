diff --git a/presto-main/src/main/java/com/facebook/presto/operator/HashGenerator.java b/presto-main/src/main/java/com/facebook/presto/operator/HashGenerator.java
index f9e7ee73b4..e51ad3bf9e 100644
--- a/presto-main/src/main/java/com/facebook/presto/operator/HashGenerator.java
+++ b/presto-main/src/main/java/com/facebook/presto/operator/HashGenerator.java
@@ -25,10 +25,13 @@ public interface HashGenerator
     {
         long rawHash = hashPosition(position, page);
 
+        // fold long to int
+        int hash = (int) (rawHash ^ (rawHash >>> 32));
+
         // clear the sign bit
-        rawHash &= 0x7fff_ffff_ffff_ffffL;
+        hash &= 0x7fff_ffff;
 
-        int partition = (int) (rawHash % partitionCount);
+        int partition = hash % partitionCount;
 
         checkState(partition >= 0 && partition < partitionCount);
         return partition;
