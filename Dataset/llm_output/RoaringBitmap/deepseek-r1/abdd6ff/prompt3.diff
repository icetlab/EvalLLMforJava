diff --git a/bsi/src/main/java/org/roaringbitmap/bsi/buffer/BitSliceIndexBase.java b/bsi/src/main/java/org/roaringbitmap/bsi/buffer/BitSliceIndexBase.java
index c40c836b..2e38d833 100644
--- a/bsi/src/main/java/org/roaringbitmap/bsi/buffer/BitSliceIndexBase.java
+++ b/bsi/src/main/java/org/roaringbitmap/bsi/buffer/BitSliceIndexBase.java
@@ -61,12 +61,12 @@ public class BitSliceIndexBase {
    * GetValue gets the value at the column ID.  Second param will be false for non-existence values.
    */
   public Pair<Integer, Boolean> getValue(int columnId) {
-    boolean exists = this.ebM.contains(columnId);
-    if (!exists) {
+    if (!this.ebM.contains(columnId)) {
       return Pair.newPair(0, false);
     }
     int value = 0;
-    for (int i = 0; i < this.bitCount(); i++) {
+    int bitCount = this.bitCount();
+    for (int i = 0; i < bitCount; i++) {
       if (this.bA[i].contains(columnId)) {
         value |= (1 << i);
       }
@@ -117,9 +117,10 @@ public class BitSliceIndexBase {
         if (cardinality == batchSize) {
           batches.add(buffer);
         } else {
-          int[] buff = new int[cardinality];
-          System.arraycopy(buffer, 0, buff, 0, cardinality);
-          batches.add(buff);
+          // Create correctly sized array without extra copy
+          int[] sizedBuffer = new int[cardinality];
+          System.arraycopy(buffer, 0, sizedBuffer, 0, cardinality);
+          batches.add(sizedBuffer);
         }
       }
     }
@@ -316,15 +317,10 @@ public class BitSliceIndexBase {
     }
 
     MutableRoaringBitmap F = ImmutableRoaringBitmap.or(G, E);
-    long n = F.getLongCardinality() - k;
-    if (n > 0) {
-      // TODO: make faster
-      IntIterator i = F.getIntIterator();
-      MutableRoaringBitmap turnoff = new MutableRoaringBitmap();
-      while (i.hasNext() && n > 0) {
-        turnoff.add(i.next());
-        --n;
-      }
+    long excess = F.getLongCardinality() - k;
+    if (excess > 0) {
+      // Use limit to efficiently get first 'excess' elements
+      MutableRoaringBitmap turnoff = F.limit((int)excess);
       F.andNot(turnoff);
     }
 
@@ -517,11 +513,11 @@ public class BitSliceIndexBase {
       return Pair.newPair(0L, 0L);
     }
     long count = foundSet.getLongCardinality();
-
-    Long sum = IntStream.range(0, this.bitCount())
-        .mapToLong(x -> (long) (1 << x) * ImmutableRoaringBitmap.andCardinality(this.bA[x], foundSet))
-        .sum();
-
+    long sum = 0L;
+    int bitCount = this.bitCount();
+    for (int i = 0; i < bitCount; i++) {
+      sum += (1L << i) * ImmutableRoaringBitmap.andCardinality(this.bA[i], foundSet);
+    }
     return Pair.newPair(sum, count);
   }
 
