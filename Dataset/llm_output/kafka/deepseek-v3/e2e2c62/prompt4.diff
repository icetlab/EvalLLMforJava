diff --git a/core/src/main/scala/kafka/security/authorizer/AclAuthorizer.scala b/core/src/main/scala/kafka/security/authorizer/AclAuthorizer.scala
index 5f2be90535..3ca3e20d5f 100644
--- a/core/src/main/scala/kafka/security/authorizer/AclAuthorizer.scala
+++ b/core/src/main/scala/kafka/security/authorizer/AclAuthorizer.scala
@@ -358,8 +358,12 @@ class AclAuthorizer extends Authorizer with Logging {
 
     val prefixed = aclCacheSnapshot
       .from(new ResourcePattern(resourceType, resourceName, PatternType.PREFIXED))
-      .to(new ResourcePattern(resourceType, resourceName.take(1), PatternType.PREFIXED))
-      .flatMap { case (resource, acls) => if (resourceName.startsWith(resource.name)) acls.acls else Seq.empty }
+      .takeWhile { case (resource, _) => 
+        resource.resourceType == resourceType && 
+        resource.patternType == PatternType.PREFIXED &&
+        resourceName.startsWith(resource.name)
+      }
+      .flatMap { case (resource, acls) => acls.acls }
       .toBuffer
 
     new AclSeqs(prefixed, wildcard, literal)
