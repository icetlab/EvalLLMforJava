diff --git a/presto-orc/src/main/java/com/facebook/presto/orc/reader/BooleanSelectiveStreamReader.java b/presto-orc/src/main/java/com/facebook/presto/orc/reader/BooleanSelectiveStreamReader.java
index aab2765889..0c56098170 100644
--- a/presto-orc/src/main/java/com/facebook/presto/orc/reader/BooleanSelectiveStreamReader.java
+++ b/presto-orc/src/main/java/com/facebook/presto/orc/reader/BooleanSelectiveStreamReader.java
@@ -196,7 +196,7 @@ public class BooleanSelectiveStreamReader
                 }
 
                 if (presentStream != null && !presentStream.nextBit()) {
-                    if ((nonDeterministicFilter && filter.testNull()) || nullsAllowed) {
+                    if (nullsAllowed || (nonDeterministicFilter && filter.testNull())) {
                         if (outputRequired) {
                             nulls[outputPositionCount] = true;
                         }
@@ -273,7 +273,8 @@ public class BooleanSelectiveStreamReader
     {
         // filter == null implies outputRequired == true
         int streamPosition = 0;
-        for (int i = 0; i < positionCount; i++) {
+        int i = 0;
+        while (i < positionCount) {
             int position = positions[i];
             if (position > streamPosition) {
                 skip(position - streamPosition);
@@ -290,6 +291,7 @@ public class BooleanSelectiveStreamReader
                 }
             }
             streamPosition++;
+            i++;
         }
         outputPositionCount = positionCount;
         return streamPosition;
@@ -312,9 +314,11 @@ public class BooleanSelectiveStreamReader
 
     private void ensureValuesCapacity(int capacity, boolean recordNulls)
     {
-        values = ensureCapacity(values, capacity);
+        if (values == null || values.length < capacity) {
+            values = ensureCapacity(values, capacity);
+        }
 
-        if (recordNulls) {
+        if (recordNulls && (nulls == null || nulls.length < capacity)) {
             nulls = ensureCapacity(nulls, capacity);
         }
     }
