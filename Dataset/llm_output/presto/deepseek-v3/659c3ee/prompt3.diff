diff --git a/presto-orc/src/main/java/com/facebook/presto/orc/reader/ByteSelectiveStreamReader.java b/presto-orc/src/main/java/com/facebook/presto/orc/reader/ByteSelectiveStreamReader.java
index 93aeb97e76..bee40fafd0 100644
--- a/presto-orc/src/main/java/com/facebook/presto/orc/reader/ByteSelectiveStreamReader.java
+++ b/presto-orc/src/main/java/com/facebook/presto/orc/reader/ByteSelectiveStreamReader.java
@@ -176,7 +176,8 @@ public class ByteSelectiveStreamReader
     {
         int streamPosition = 0;
         outputPositionCount = 0;
-        for (int i = 0; i < positionCount; i++) {
+        int i = 0;
+        while (i < positionCount) {
             int position = positions[i];
             if (position > streamPosition) {
                 skip(position - streamPosition);
@@ -206,17 +207,18 @@ public class ByteSelectiveStreamReader
                 }
             }
             streamPosition++;
+            i++;
 
             if (filter != null) {
                 outputPositionCount -= filter.getPrecedingPositionsToFail();
                 int succeedingPositionsToFail = filter.getSucceedingPositionsToFail();
                 if (succeedingPositionsToFail > 0) {
                     int positionsToSkip = 0;
-                    for (int j = 0; j < succeedingPositionsToFail; j++) {
-                        i++;
+                    for (int j = 0; j < succeedingPositionsToFail && i < positionCount; j++) {
                         int nextPosition = positions[i];
                         positionsToSkip += 1 + nextPosition - streamPosition;
                         streamPosition = nextPosition + 1;
+                        i++;
                     }
                     skip(positionsToSkip);
                 }
@@ -265,7 +267,8 @@ public class ByteSelectiveStreamReader
         }
 
         int streamPosition = 0;
-        for (int i = 0; i < positionCount; i++) {
+        int i = 0;
+        while (i < positionCount) {
             int position = positions[i];
             if (position > streamPosition) {
                 skip(position - streamPosition);
@@ -282,6 +285,7 @@ public class ByteSelectiveStreamReader
                 }
             }
             streamPosition++;
+            i++;
         }
         outputPositionCount = positionCount;
         return streamPosition;
@@ -290,12 +294,17 @@ public class ByteSelectiveStreamReader
     private void skip(int items)
             throws IOException
     {
+        if (items <= 0) {
+            return;
+        }
         if (dataStream == null) {
             presentStream.skip(items);
         }
         else if (presentStream != null) {
             int dataToSkip = presentStream.countBitsSet(items);
-            dataStream.skip(dataToSkip);
+            if (dataToSkip > 0) {
+                dataStream.skip(dataToSkip);
+            }
         }
         else {
             dataStream.skip(items);
diff --git a/presto-orc/src/main/java/com/facebook/presto/orc/reader/ReaderUtils.java b/presto-orc/src/main/java/com/facebook/presto/orc/reader/ReaderUtils.java
index 720023399d..216cdcc8a8 100644
--- a/presto-orc/src/main/java/com/facebook/presto/orc/reader/ReaderUtils.java
+++ b/presto-orc/src/main/java/com/facebook/presto/orc/reader/ReaderUtils.java
@@ -52,8 +52,7 @@ final class ReaderUtils
         int position = 0;
         for (int i = 0; i < isNull.length; i++) {
             if (!isNull[i]) {
-                result[i] = values[position];
-                position++;
+                result[i] = values[position++];
             }
         }
         return result;
@@ -66,8 +65,7 @@ final class ReaderUtils
         int position = 0;
         for (int i = 0; i < isNull.length; i++) {
             if (!isNull[i]) {
-                result[i] = values[position];
-                position++;
+                result[i] = values[position++];
             }
         }
         return result;
@@ -80,8 +78,7 @@ final class ReaderUtils
         int position = 0;
         for (int i = 0; i < isNull.length; i++) {
             if (!isNull[i]) {
-                result[i] = values[position];
-                position++;
+                result[i] = values[position++];
             }
         }
         return result;
@@ -94,8 +91,7 @@ final class ReaderUtils
         int position = 0;
         for (int i = 0; i < isNull.length; i++) {
             if (!isNull[i]) {
-                result[i] = values[position];
-                position++;
+                result[i] = values[position++];
             }
         }
         return result;
