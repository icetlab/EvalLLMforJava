diff --git a/presto-orc/src/main/java/com/facebook/presto/orc/reader/ByteSelectiveStreamReader.java b/presto-orc/src/main/java/com/facebook/presto/orc/reader/ByteSelectiveStreamReader.java
index da887a9ba3..9ff573f07c 100644
--- a/presto-orc/src/main/java/com/facebook/presto/orc/reader/ByteSelectiveStreamReader.java
+++ b/presto-orc/src/main/java/com/facebook/presto/orc/reader/ByteSelectiveStreamReader.java
@@ -176,7 +176,8 @@ public class ByteSelectiveStreamReader
     {
         int streamPosition = 0;
         outputPositionCount = 0;
-        for (int i = 0; i < positionCount; i++) {
+        int i = 0;
+        while (i < positionCount) {
             int position = positions[i];
             if (position > streamPosition) {
                 skip(position - streamPosition);
@@ -206,19 +207,25 @@ public class ByteSelectiveStreamReader
                 }
             }
             streamPosition++;
+            i++;
 
             if (filter != null) {
-                outputPositionCount -= filter.getPrecedingPositionsToFail();
-                int succeedingPositionsToFail = filter.getSucceedingPositionsToFail();
-                if (succeedingPositionsToFail > 0) {
-                    int positionsToSkip = 0;
-                    for (int j = 0; j < succeedingPositionsToFail; j++) {
-                        i++;
+                int precedingFailures = filter.getPrecedingPositionsToFail();
+                if (precedingFailures > 0) {
+                    outputPositionCount = Math.max(0, outputPositionCount - precedingFailures);
+                }
+                int succeedingFailures = filter.getSucceedingPositionsToFail();
+                if (succeedingFailures > 0) {
+                    int skipCount = 0;
+                    for (int j = 0; j < succeedingFailures && i < positionCount; j++) {
                         int nextPosition = positions[i];
-                        positionsToSkip += 1 + nextPosition - streamPosition;
+                        skipCount += nextPosition - streamPosition + 1;
                         streamPosition = nextPosition + 1;
+                        i++;
+                    }
+                    if (skipCount > 0) {
+                        skip(skipCount);
                     }
-                    skip(positionsToSkip);
                 }
             }
         }
@@ -270,9 +277,7 @@ public class ByteSelectiveStreamReader
             }
             else {
                 values[i] = dataStream.next();
-                if (presentStream != null) {
-                    nulls[i] = false;
-                }
+                // No need to set nulls[i] = false here because nulls array is initialized to false
             }
             streamPosition++;
         }
diff --git a/presto-orc/src/main/java/com/facebook/presto/orc/stream/ByteInputStream.java b/presto-orc/src/main/java/com/facebook/presto/orc/stream/ByteInputStream.java
index 21edc123eb..7099c9f808 100644
--- a/presto-orc/src/main/java/com/facebook/presto/orc/stream/ByteInputStream.java
+++ b/presto-orc/src/main/java/com/facebook/presto/orc/stream/ByteInputStream.java
@@ -100,20 +100,29 @@ public class ByteInputStream
     public void skip(long items)
             throws IOException
     {
+        if (items <= 0) {
+            return;
+        }
         while (items > 0) {
             if (offset == length) {
                 readNextBlock();
             }
-            long consume = Math.min(items, length - offset);
-            offset += consume;
-            items -= consume;
+            long available = length - offset;
+            if (items >= available) {
+                items -= available;
+                offset = length;
+            }
+            else {
+                offset += items;
+                items = 0;
+            }
         }
     }
 
     public byte next()
             throws IOException
     {
-        if (offset == length) {
+        if (offset >= length) {
             readNextBlock();
         }
         return buffer[offset++];
