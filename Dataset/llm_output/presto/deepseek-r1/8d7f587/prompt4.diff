diff --git a/presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/GeoFunctions.java b/presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/GeoFunctions.java
index de0d7c23a6..ca2103f8a8 100644
--- a/presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/GeoFunctions.java
+++ b/presto-geospatial/src/main/java/com/facebook/presto/plugin/geospatial/GeoFunctions.java
@@ -242,9 +242,8 @@ public final class GeoFunctions
     @SqlType(DOUBLE)
     public static double stXMax(@SqlType(GEOMETRY_TYPE_NAME) Slice input)
     {
-        OGCGeometry geometry = deserialize(input);
-        Envelope envelope = getEnvelope(geometry);
-        return envelope.getXMax();
+        Envelope envelope = deserializeEnvelope(input);
+        return envelope == null ? Double.NaN : envelope.getXMax();
     }
 
     @Description("Returns Y maxima of a bounding box of a Geometry")
@@ -252,9 +251,8 @@ public final class GeoFunctions
     @SqlType(DOUBLE)
     public static double stYMax(@SqlType(GEOMETRY_TYPE_NAME) Slice input)
     {
-        OGCGeometry geometry = deserialize(input);
-        Envelope envelope = getEnvelope(geometry);
-        return envelope.getYMax();
+        Envelope envelope = deserializeEnvelope(input);
+        return envelope == null ? Double.NaN : envelope.getYMax();
     }
 
     @Description("Returns X minima of a bounding box of a Geometry")
@@ -262,9 +260,8 @@ public final class GeoFunctions
     @SqlType(DOUBLE)
     public static double stXMin(@SqlType(GEOMETRY_TYPE_NAME) Slice input)
     {
-        OGCGeometry geometry = deserialize(input);
-        Envelope envelope = getEnvelope(geometry);
-        return envelope.getXMin();
+        Envelope envelope = deserializeEnvelope(input);
+        return envelope == null ? Double.NaN : envelope.getXMin();
     }
 
     @Description("Returns Y minima of a bounding box of a Geometry")
@@ -272,9 +269,8 @@ public final class GeoFunctions
     @SqlType(DOUBLE)
     public static double stYMin(@SqlType(GEOMETRY_TYPE_NAME) Slice input)
     {
-        OGCGeometry geometry = deserialize(input);
-        Envelope envelope = getEnvelope(geometry);
-        return envelope.getYMin();
+        Envelope envelope = deserializeEnvelope(input);
+        return envelope == null ? Double.NaN : envelope.getYMin();
     }
 
     @SqlNullable
@@ -392,10 +388,14 @@ public final class GeoFunctions
     @SqlType(GEOMETRY_TYPE_NAME)
     public static Slice stEnvelope(@SqlType(GEOMETRY_TYPE_NAME) Slice input)
     {
-        OGCGeometry geometry = deserialize(input);
-        SpatialReference reference = geometry.getEsriSpatialReference();
-        Envelope envelope = getEnvelope(geometry);
-        return serialize(createFromEsriGeometry(envelope, reference));
+        Envelope envelope = deserializeEnvelope(input);
+        if (envelope == null) {
+            // Return an empty geometry if the input is empty
+            OGCGeometry emptyGeometry = createFromEsriGeometry(new Polygon(), null);
+            return serialize(emptyGeometry);
+        }
+        // Create envelope geometry directly from the envelope
+        return serialize(createFromEsriGeometry(envelope, null));
     }
 
     @Description("Returns the Geometry value that represents the point set difference of two geometries")
