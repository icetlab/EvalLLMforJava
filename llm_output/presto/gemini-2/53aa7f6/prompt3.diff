diff --git a/presto-main/src/main/java/com/facebook/presto/operator/project/GeneratedPageProjection.java b/presto-main/src/main/java/com/facebook/presto/operator/project/GeneratedPageProjection.java
index bc8850802d..0ce2be32d4 100644
--- a/presto-main/src/main/java/com/facebook/presto/operator/project/GeneratedPageProjection.java
+++ b/presto-main/src/main/java/com/facebook/presto/operator/project/GeneratedPageProjection.java
@@ -23,6 +23,7 @@ import com.facebook.presto.spi.relation.RowExpression;
 import com.google.common.collect.ImmutableList;
 
 import java.lang.invoke.MethodHandle;
+import java.util.ArrayList;
 import java.util.List;
 
 import static com.google.common.base.MoreObjects.toStringHelper;
@@ -63,9 +64,13 @@ public class GeneratedPageProjection
     @Override
     public Work<List<Block>> project(SqlFunctionProperties properties, DriverYieldSignal yieldSignal, Page page, SelectedPositions selectedPositions)
     {
-        blockBuilders = blockBuilders.stream().map(blockBuilder -> blockBuilder.newBlockBuilderLike(null)).collect(toImmutableList());
+        List<BlockBuilder> newBlockBuilders = new ArrayList<>(blockBuilders.size());
+        for (BlockBuilder blockBuilder : blockBuilders) {
+            newBlockBuilders.add(blockBuilder.newBlockBuilderLike(null));
+        }
+
         try {
-            return (Work<List<Block>>) pageProjectionWorkFactory.invoke(blockBuilders, properties, page, selectedPositions);
+            return (Work<List<Block>>) pageProjectionWorkFactory.invoke(newBlockBuilders, properties, page, selectedPositions);
         }
         catch (Throwable e) {
             throw new RuntimeException(e);
