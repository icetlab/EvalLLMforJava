diff --git a/presto-orc/src/main/java/com/facebook/presto/orc/reader/SliceDirectSelectiveStreamReader.java b/presto-orc/src/main/java/com/facebook/presto/orc/reader/SliceDirectSelectiveStreamReader.java
index 79b56c6971..eeb1c11892 100644
--- a/presto-orc/src/main/java/com/facebook/presto/orc/reader/SliceDirectSelectiveStreamReader.java
+++ b/presto-orc/src/main/java/com/facebook/presto/orc/reader/SliceDirectSelectiveStreamReader.java
@@ -633,7 +633,6 @@ public class SliceDirectSelectiveStreamReader
         outputPositionCount = 0;
 
         int totalLength = 0;
-        int maxLength = 0;
         int dataLength = 0;
 
         int totalPositions = positions[positionCount - 1] + 1;
@@ -649,20 +648,21 @@ public class SliceDirectSelectiveStreamReader
             lengthStream.nextIntVector(nonNullCount, lengthVector, 0);
 
             if (useBatchMode(positionCount, totalPositions)) {
+                long sum = 0;
                 for (int i = 0; i < nonNullCount; i++) {
-                    totalLength += lengthVector[i];
-                    maxLength = Math.max(maxLength, lengthVector[i]);
+                    sum += lengthVector[i];
                 }
+                totalLength = toIntExact(sum);
             }
             else {
+                long sum = 0;
                 int positionIndex = 0;
                 int lengthIndex = 0;
                 for (int i = 0; i < totalPositions; i++) {
                     boolean isNotNull = nullCount == 0 || !isNullVector[i];
                     if (i == positions[positionIndex]) {
                         if (isNotNull) {
-                            totalLength += lengthVector[lengthIndex];
-                            maxLength = Math.max(maxLength, lengthVector[lengthIndex]);
+                            sum += lengthVector[lengthIndex];
                             lengthIndex++;
                         }
                         positionIndex++;
@@ -671,6 +671,7 @@ public class SliceDirectSelectiveStreamReader
                         lengthIndex++;
                     }
                 }
+                totalLength = toIntExact(sum);
             }
 
             // TODO Do not throw if outputRequired == false
@@ -698,7 +699,7 @@ public class SliceDirectSelectiveStreamReader
                 }
             }
             else {
-                dataLength = maxLength;
+                dataLength = 0;
             }
 
             data = ensureCapacity(data, dataLength);
