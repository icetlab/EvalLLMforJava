diff --git a/presto-main/src/main/java/com/facebook/presto/operator/HashGenerator.java b/presto-main/src/main/java/com/facebook/presto/operator/HashGenerator.java
index f9e7ee73b4..67a2ba15e5 100644
--- a/presto-main/src/main/java/com/facebook/presto/operator/HashGenerator.java
+++ b/presto-main/src/main/java/com/facebook/presto/operator/HashGenerator.java
@@ -28,7 +28,14 @@ public interface HashGenerator
         // clear the sign bit
         rawHash &= 0x7fff_ffff_ffff_ffffL;
 
-        int partition = (int) (rawHash % partitionCount);
+        int partition;
+        // A power of 2 partition count allows us to use a bitwise AND instead of the more expensive modulo operator
+        if (partitionCount > 0 && (partitionCount & (partitionCount - 1)) == 0) {
+            partition = (int) (rawHash & (partitionCount - 1));
+        }
+        else {
+            partition = (int) (rawHash % partitionCount);
+        }
 
         checkState(partition >= 0 && partition < partitionCount);
         return partition;
