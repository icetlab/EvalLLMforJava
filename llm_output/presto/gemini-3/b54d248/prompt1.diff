diff --git a/presto-main/src/main/java/com/facebook/presto/operator/HashGenerator.java b/presto-main/src/main/java/com/facebook/presto/operator/HashGenerator.java
index f9e7ee73b4..d9bbacee70 100644
--- a/presto-main/src/main/java/com/facebook/presto/operator/HashGenerator.java
+++ b/presto-main/src/main/java/com/facebook/presto/operator/HashGenerator.java
@@ -25,12 +25,13 @@ public interface HashGenerator
     {
         long rawHash = hashPosition(position, page);
 
-        // clear the sign bit
-        rawHash &= 0x7fff_ffff_ffff_ffffL;
-
-        int partition = (int) (rawHash % partitionCount);
+        // Power of 2 partition count is a special case that can be optimized using bitwise AND
+        if ((partitionCount & (partitionCount - 1)) == 0) {
+            return (int) (rawHash & (partitionCount - 1));
+        }
 
-        checkState(partition >= 0 && partition < partitionCount);
-        return partition;
+        // In the general case, we need to clear the sign bit of the hash to ensure
+        // that the result of the modulo is non-negative
+        return (int) ((rawHash & 0x7fff_ffff_ffff_ffffL) % partitionCount);
     }
 }
