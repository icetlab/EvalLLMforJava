The overall improvement is to defer the retained memory calculation in `PageProcessor` from object construction to the first time processing occurs. The original code calculated the retained size of the input page in the `ProjectSelectedPositions` constructor, which is an unnecessary upfront cost as processing starts immediately after creation.

The changes are as follows:
1.  The call to `updateRetainedSize()` is removed from the `ProjectSelectedPositions` constructor, avoiding the performance cost at construction time.
2.  A call to `updateRetainedSize()` is added before the processor yields. This ensures that retained memory is correctly accounted for if processing is paused and the page is held for future processing. This also fixes a pre-existing bug where memory of partially computed results was not accounted for upon yielding.

These changes ensure that memory accounting is performed only when necessary, reducing processing overhead while maintaining correct memory tracking.

```json
[
  {
    "filepath": "../presto/presto-main/src/main/java/com/facebook/presto/operator/project/PageProcessor.java",
    "search": "        private ProjectSelectedPositions(ConnectorSession session, DriverYieldSignal yieldSignal, LocalMemoryContext memoryContext, Page page, SelectedPositions selectedPositions)\n        {\n            this.session = session;\n            this.yieldSignal = yieldSignal;\n            this.page = page;\n            this.memoryContext = memoryContext;\n            this.selectedPositions = selectedPositions;\n            this.previouslyComputedResults = new Block[projections.size()];\n            updateRetainedSize();\n        }",
    "replace": "        private ProjectSelectedPositions(ConnectorSession session, DriverYieldSignal yieldSignal, LocalMemoryContext memoryContext, Page page, SelectedPositions selectedPositions)\n        {\n            this.session = session;\n            this.yieldSignal = yieldSignal;\n            this.page = page;\n            this.memoryContext = memoryContext;\n            this.selectedPositions = selectedPositions;\n            this.previouslyComputedResults = new Block[projections.size()];\n        }"
  },
  {
    "filepath": "../presto/presto-main/src/main/java/com/facebook/presto/operator/project/PageProcessor.java",
    "search": "                if (result.isYieldFinish()) {\n                    // if we are running out of time, save the batch size and continue next time\n                    lastComputeYielded = true;\n                    lastComputeBatchSize = batchSize;\n                    return yield();\n                }",
    "replace": "                if (result.isYieldFinish()) {\n                    // if we are running out of time, save the batch size and continue next time\n                    lastComputeYielded = true;\n                    lastComputeBatchSize = batchSize;\n                    updateRetainedSize();\n                    return yield();\n                }"
  }
]
```