diff --git a/presto-main/src/main/java/com/facebook/presto/tdigest/TDigest.java b/presto-main/src/main/java/com/facebook/presto/tdigest/TDigest.java
index ce0ca747f2..78caeee400 100644
--- a/presto-main/src/main/java/com/facebook/presto/tdigest/TDigest.java
+++ b/presto-main/src/main/java/com/facebook/presto/tdigest/TDigest.java
@@ -215,15 +215,17 @@ public class TDigest
         checkArgument(other != null, "Cannot merge with a null t-digest");
         checkArgument(this.publicCompression == other.getCompressionFactor(), "TDigests must have the same compression, found (%s, %s)", this.publicCompression,
                 other.getCompressionFactor());
-        List<Centroid> tmp = new ArrayList<>();
-        for (Centroid centroid : other.centroids()) {
-            tmp.add(centroid);
-        }
-
-        shuffle(tmp, gen);
-        for (Centroid centroid : tmp) {
-            add(centroid.getMean(), centroid.getWeight());
-        }
+        // flush any pending values in both digests
+        this.mergeNewValues();
+        other.mergeNewValues();
+        int otherCount = other.activeCentroids;
+        // copy other centroids to temporary buffers
+        arraycopy(other.mean, 0, tempMean, 0, otherCount);
+        arraycopy(other.weight, 0, tempWeight, 0, otherCount);
+        // merge centroids in one shot
+        boolean runBackwards = mergeCount % 2 == 1;
+        merge(tempMean, tempWeight, otherCount, order, other.totalWeight, runBackwards, compression);
+        mergeCount++;
     }
 
     private void mergeNewValues()
