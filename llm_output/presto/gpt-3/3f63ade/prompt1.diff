diff --git a/presto-main/src/main/java/com/facebook/presto/operator/scalar/ArrayDistinctFunction.java b/presto-main/src/main/java/com/facebook/presto/operator/scalar/ArrayDistinctFunction.java
index a25a5916e6..b5ceec776c 100644
--- a/presto-main/src/main/java/com/facebook/presto/operator/scalar/ArrayDistinctFunction.java
+++ b/presto-main/src/main/java/com/facebook/presto/operator/scalar/ArrayDistinctFunction.java
@@ -72,19 +72,32 @@ public final class ArrayDistinctFunction
 
     public static Block distinct(Type type, Block array)
     {
-        if (array.getPositionCount() == 0) {
+        int positionCount = array.getPositionCount();
+        if (positionCount == 0) {
             return array;
         }
 
-        TypedSet typedSet = new TypedSet(type, array.getPositionCount());
-        BlockBuilder distinctElementBlockBuilder = type.createBlockBuilder(new BlockBuilderStatus(), array.getPositionCount());
-        for (int i = 0; i < array.getPositionCount(); i++) {
+        TypedSet typedSet = new TypedSet(type, positionCount);
+        BlockBuilder builder = null;
+        for (int i = 0; i < positionCount; i++) {
             if (!typedSet.contains(array, i)) {
                 typedSet.add(array, i);
-                type.appendTo(array, i, distinctElementBlockBuilder);
+                if (builder != null) {
+                    type.appendTo(array, i, builder);
+                }
+            }
+            else {
+                // first duplicate found, initialize builder and copy previous distinct elements
+                if (builder == null) {
+                    builder = type.createBlockBuilder(new BlockBuilderStatus(), positionCount);
+                    for (int j = 0; j < i; j++) {
+                        type.appendTo(array, j, builder);
+                    }
+                }
+                // skip duplicate element
             }
         }
 
-        return distinctElementBlockBuilder.build();
+        return (builder == null) ? array : builder.build();
     }
 }
