diff --git a/presto-main/src/main/java/com/facebook/presto/operator/project/PageProcessor.java b/presto-main/src/main/java/com/facebook/presto/operator/project/PageProcessor.java
index 979fc2cb80..1d793961da 100644
--- a/presto-main/src/main/java/com/facebook/presto/operator/project/PageProcessor.java
+++ b/presto-main/src/main/java/com/facebook/presto/operator/project/PageProcessor.java
@@ -217,12 +217,12 @@ public class PageProcessor
                 // if we produced a large page or if the expression is expensive, halve the batch size for the next call
                 long pageSize = resultPage.getSizeInBytes();
                 if (resultPage.getPositionCount() > 1 && (pageSize > MAX_PAGE_SIZE_IN_BYTES || expressionProfiler.isExpressionExpensive())) {
-                    projectBatchSize = projectBatchSize / 2;
+                    projectBatchSize = Math.max(projectBatchSize / 2, 1);
                 }
 
                 // if we produced a small page, double the batch size for the next call
                 if (pageSize < MIN_PAGE_SIZE_IN_BYTES && projectBatchSize < MAX_BATCH_SIZE && !expressionProfiler.isExpressionExpensive()) {
-                    projectBatchSize = projectBatchSize * 2;
+                    projectBatchSize = Math.min(projectBatchSize * 2, MAX_BATCH_SIZE);
                 }
 
                 // remove batch from selectedPositions and previouslyComputedResults
