The intent of these changes is to avoid eagerly resizing each partitionâ€™s `positions` array to the full page size on every page, and instead grow it lazily only as needed. This reduces wasted memory when most partitions receive only a few rows.

```json
[
  {
    "filepath": "../presto/presto-main/src/main/java/com/facebook/presto/operator/repartition/OptimizedPartitionedOutputOperator.java",
    "search": "private void resetPositions(int positionCount)\n    {\n        positions = ensureCapacity(positions, positionCount);\n        this.positionCount = 0;\n    }",
    "replace": "private void resetPositions(int positionCount)\n    {\n        // Reset position count only; avoid resizing positions array to full page size\n        this.positionCount = 0;\n    }"
  },
  {
    "filepath": "../presto/presto-main/src/main/java/com/facebook/presto/operator/repartition/OptimizedPartitionedOutputOperator.java",
    "search": "private void addPosition(int position)\n        {\n            positions[positionCount++] = position;\n        }",
    "replace": "private void addPosition(int position)\n        {\n            // Ensure capacity for new position\n            positions = ensureCapacity(positions, positionCount + 1);\n            positions[positionCount++] = position;\n        }"
  }
]
```