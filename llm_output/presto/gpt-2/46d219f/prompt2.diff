diff --git a/presto-main/src/main/java/com/facebook/presto/operator/scalar/MapConcatFunction.java b/presto-main/src/main/java/com/facebook/presto/operator/scalar/MapConcatFunction.java
index 24e83bddde..0c66466eb9 100644
--- a/presto-main/src/main/java/com/facebook/presto/operator/scalar/MapConcatFunction.java
+++ b/presto-main/src/main/java/com/facebook/presto/operator/scalar/MapConcatFunction.java
@@ -40,6 +40,13 @@ public final class MapConcatFunction
             @SqlType("map(K,V)") Block leftMap,
             @SqlType("map(K,V)") Block rightMap)
     {
+        // optimize: skip concatenation when one of the maps is empty
+        if (rightMap.getPositionCount() == 0) {
+            return leftMap;
+        }
+        if (leftMap.getPositionCount() == 0) {
+            return rightMap;
+        }
         TypedSet typedSet = new TypedSet(keyType, rightMap.getPositionCount());
         BlockBuilder blockBuilder = new InterleavedBlockBuilder(ImmutableList.of(keyType, valueType), new BlockBuilderStatus(), leftMap.getPositionCount() + rightMap.getPositionCount());
         for (int i = 0; i < rightMap.getPositionCount(); i += 2) {
