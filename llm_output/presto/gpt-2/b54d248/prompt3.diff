diff --git a/presto-main/src/main/java/com/facebook/presto/operator/HashGenerator.java b/presto-main/src/main/java/com/facebook/presto/operator/HashGenerator.java
index f9e7ee73b4..1ffd363dba 100644
--- a/presto-main/src/main/java/com/facebook/presto/operator/HashGenerator.java
+++ b/presto-main/src/main/java/com/facebook/presto/operator/HashGenerator.java
@@ -24,13 +24,15 @@ public interface HashGenerator
     default int getPartition(int partitionCount, int position, Page page)
     {
         long rawHash = hashPosition(position, page);
-
-        // clear the sign bit
-        rawHash &= 0x7fff_ffff_ffff_ffffL;
-
-        int partition = (int) (rawHash % partitionCount);
-
-        checkState(partition >= 0 && partition < partitionCount);
+        final int partition;
+        // fast path for power-of-two partition counts
+        if ((partitionCount & (partitionCount - 1)) == 0) {
+            partition = (int) (rawHash & (partitionCount - 1));
+        }
+        else {
+            long positiveHash = rawHash & Long.MAX_VALUE;
+            partition = (int) (positiveHash % partitionCount);
+        }
         return partition;
     }
 }
