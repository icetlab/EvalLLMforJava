diff --git a/presto-main/src/main/java/com/facebook/presto/operator/WindowOperator.java b/presto-main/src/main/java/com/facebook/presto/operator/WindowOperator.java
index 6813ba04fa..a7042ce96d 100644
--- a/presto-main/src/main/java/com/facebook/presto/operator/WindowOperator.java
+++ b/presto-main/src/main/java/com/facebook/presto/operator/WindowOperator.java
@@ -846,6 +846,11 @@ public class WindowOperator
 
     private int updatePagesIndex(PagesIndexWithHashStrategies pagesIndexWithHashStrategies, Page page, int startPosition, Optional<Page> currentSpillGroupRowPage)
     {
+        // fast path: if no pre-grouping, treat entire stream as a single group
+        if (pagesIndexWithHashStrategies.preGroupedPartitionChannels.length == 0) {
+            pagesIndexWithHashStrategies.pagesIndex.addPage(page);
+            return page.getPositionCount();
+        }
         checkArgument(page.getPositionCount() > startPosition);
 
         // TODO: Fix pagesHashStrategy to allow specifying channels for comparison, it currently requires us to rearrange the right side blocks in consecutive channel order
