Iâ€™ve added a fast-path in updatePagesIndex to skip partition grouping logic when there are no pre-grouped channels, avoiding unnecessary page extraction and clustering overhead.

```json
[
  {
    "filepath": "../presto/presto-main/src/main/java/com/facebook/presto/operator/WindowOperator.java",
    "search": "private int updatePagesIndex(PagesIndexWithHashStrategies pagesIndexWithHashStrategies, Page page, int startPosition, Optional<Page> currentSpillGroupRowPage)\n    {\n        checkArgument(page.getPositionCount() > startPosition);",
    "replace": "private int updatePagesIndex(PagesIndexWithHashStrategies pagesIndexWithHashStrategies, Page page, int startPosition, Optional<Page> currentSpillGroupRowPage)\n    {\n        // fast path: if no pre-grouping, treat entire stream as a single group\n        if (pagesIndexWithHashStrategies.preGroupedPartitionChannels.length == 0) {\n            pagesIndexWithHashStrategies.pagesIndex.addPage(page);\n            return page.getPositionCount();\n        }\n        checkArgument(page.getPositionCount() > startPosition);"
  }
]
```