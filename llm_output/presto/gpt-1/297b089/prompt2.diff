diff --git a/presto-orc/src/main/java/com/facebook/presto/orc/reader/SliceDirectSelectiveStreamReader.java b/presto-orc/src/main/java/com/facebook/presto/orc/reader/SliceDirectSelectiveStreamReader.java
index 79b56c6971..f964a9d04a 100644
--- a/presto-orc/src/main/java/com/facebook/presto/orc/reader/SliceDirectSelectiveStreamReader.java
+++ b/presto-orc/src/main/java/com/facebook/presto/orc/reader/SliceDirectSelectiveStreamReader.java
@@ -710,7 +710,29 @@ public class SliceDirectSelectiveStreamReader
 
     private boolean useBatchMode(int positionCount, int totalPositionCount)
     {
+        // maxCodePointCount < 0 means it's unbounded varchar VARCHAR.
+        // If the types are VARCHAR(N) or CHAR(N), the length of the string need to be calculated and truncated.
+        if (lengthStream == null || maxCodePointCount >= 0) {
+            return false;
+        }
+
+        double inputFilterRate = (double) (totalPositionCount - positionCount) / totalPositionCount;
+        if (filter == null) {  // readNoFilter
+            // When there is no filter, batch mode performs better for almost all inputFilterRate.
+            // But to limit data buffer size, we enable it for the range of [0.0, 0.5]
+            if (inputFilterRate >= 0.0 && inputFilterRate <= 0.5) {
                 return true;
+            }
+            return false;
+        }
+        else { // readWithFilter
+            // When there is filter, batch mode performs better for almost all inputFilterRate except around 0.1.
+            // To limit data buffer size, we enable it for the ranges [0.0, 0.05] and [0.15, 0.5]
+            if ((inputFilterRate >= 0.0 && inputFilterRate <= 0.05) || (inputFilterRate >= 0.15 && inputFilterRate <= 0.5)) {
+                return true;
+            }
+            return false;
+        }
         // maxCodePointCount < 0 means it's unbounded varchar VARCHAR.
         // If the types are VARCHAR(N) or CHAR(N), the length of the string need to be calculated and truncated.
 //        if (lengthStream == null || maxCodePointCount >= 0) {
