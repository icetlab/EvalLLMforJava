diff --git a/presto-main/src/main/java/com/facebook/presto/operator/scalar/ArrayDistinctFunction.java b/presto-main/src/main/java/com/facebook/presto/operator/scalar/ArrayDistinctFunction.java
index a25a5916e6..93fb58bc05 100644
--- a/presto-main/src/main/java/com/facebook/presto/operator/scalar/ArrayDistinctFunction.java
+++ b/presto-main/src/main/java/com/facebook/presto/operator/scalar/ArrayDistinctFunction.java
@@ -75,6 +75,18 @@ public final class ArrayDistinctFunction
         if (array.getPositionCount() == 0) {
             return array;
         }
+        if (array.getPositionCount() == 1) {
+            return array;
+        }
+        if (array.getPositionCount() == 2) {
+            // optimized for two elements
+            if (type.equalTo(array, 0, array, 1)) {
+                BlockBuilder builder = type.createBlockBuilder(new BlockBuilderStatus(), 1);
+                type.appendTo(array, 0, builder);
+                return builder.build();
+            }
+            return array;
+        }
 
         TypedSet typedSet = new TypedSet(type, array.getPositionCount());
         BlockBuilder distinctElementBlockBuilder = type.createBlockBuilder(new BlockBuilderStatus(), array.getPositionCount());
