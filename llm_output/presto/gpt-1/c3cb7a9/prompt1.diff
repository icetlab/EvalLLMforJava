diff --git a/presto-main/src/main/java/com/facebook/presto/operator/WindowOperator.java b/presto-main/src/main/java/com/facebook/presto/operator/WindowOperator.java
index 6813ba04fa..a3da9af58e 100644
--- a/presto-main/src/main/java/com/facebook/presto/operator/WindowOperator.java
+++ b/presto-main/src/main/java/com/facebook/presto/operator/WindowOperator.java
@@ -236,16 +236,22 @@ public class WindowOperator
 
         this.operatorContext = operatorContext;
         this.outputChannels = Ints.toArray(outputChannels);
-        this.windowFunctions = windowFunctionDefinitions.stream()
-                .map(functionDefinition -> new FramedWindowFunction(functionDefinition.createWindowFunction(), functionDefinition.getFrameInfo()))
-                .collect(toImmutableList());
+        ImmutableList.Builder<FramedWindowFunction> windowFunctionsBuilder = ImmutableList.builder();
+            for (WindowFunctionDefinition functionDefinition : windowFunctionDefinitions) {
+                windowFunctionsBuilder.add(new FramedWindowFunction(
+                        functionDefinition.createWindowFunction(),
+                        functionDefinition.getFrameInfo()));
+            }
+            this.windowFunctions = windowFunctionsBuilder.build();
 
-        this.outputTypes = Stream.concat(
-                outputChannels.stream()
-                        .map(sourceTypes::get),
-                windowFunctionDefinitions.stream()
-                        .map(WindowFunctionDefinition::getType))
-                .collect(toImmutableList());
+        ImmutableList.Builder<Type> outputTypesBuilder = ImmutableList.builder();
+        for (int channel : outputChannels) {
+            outputTypesBuilder.add(sourceTypes.get(channel));
+        }
+        for (WindowFunctionDefinition functionDefinition : windowFunctionDefinitions) {
+            outputTypesBuilder.add(functionDefinition.getType());
+        }
+        this.outputTypes = outputTypesBuilder.build();
 
         List<Integer> unGroupedPartitionChannels = partitionChannels.stream()
                 .filter(channel -> !preGroupedChannels.contains(channel))
