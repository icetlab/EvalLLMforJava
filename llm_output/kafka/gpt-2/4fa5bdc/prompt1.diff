diff --git a/core/src/main/scala/kafka/security/authorizer/AclAuthorizer.scala b/core/src/main/scala/kafka/security/authorizer/AclAuthorizer.scala
index 58860be864..0645144b47 100644
--- a/core/src/main/scala/kafka/security/authorizer/AclAuthorizer.scala
+++ b/core/src/main/scala/kafka/security/authorizer/AclAuthorizer.scala
@@ -353,11 +353,11 @@ class AclAuthorizer extends Authorizer with Logging {
       .getOrElse(Set.empty)
 
     val prefixed = aclCacheSnapshot
-      .from(new ResourcePattern(resourceType, resourceName, PatternType.PREFIXED))
-      .to(new ResourcePattern(resourceType, resourceName.take(1), PatternType.PREFIXED))
-      .filterKeys(resource => resourceName.startsWith(resource.name))
+      .filter { case (rp, versioned) =>
+        rp.resourceType == resourceType && rp.patternType == PatternType.PREFIXED && resourceName.startsWith(rp.name)
+      }
       .values
-      .flatMap { _.acls }
+      .flatMap(_.acls)
       .toSet
 
     new AclSets(prefixed, wildcard, literal)
@@ -371,7 +371,7 @@ class AclAuthorizer extends Authorizer with Logging {
                                 acls: AclSets): Boolean = {
     acls.find { acl =>
       acl.permissionType == permissionType &&
-        (acl.kafkaPrincipal == principal || acl.kafkaPrincipal == AclEntry.WildcardPrincipal) &&
+        ((acl.kafkaPrincipal.getPrincipalType == principal.getPrincipalType && acl.kafkaPrincipal.getName == principal.getName) || acl.kafkaPrincipal == AclEntry.WildcardPrincipal) &&
         (operation == acl.operation || acl.operation == AclOperation.ALL) &&
         (acl.host == host || acl.host == AclEntry.WildcardHost)
     }.exists { acl =>
