diff --git a/clients/src/main/java/org/apache/kafka/common/internals/PartitionStates.java b/clients/src/main/java/org/apache/kafka/common/internals/PartitionStates.java
index c289eaa59b..73e9f83680 100644
--- a/clients/src/main/java/org/apache/kafka/common/internals/PartitionStates.java
+++ b/clients/src/main/java/org/apache/kafka/common/internals/PartitionStates.java
@@ -58,13 +58,14 @@ public class PartitionStates<S> {
     }
 
     public void updateAndMoveToEnd(TopicPartition topicPartition, S state) {
-        map.remove(topicPartition);
+        S prev = map.remove(topicPartition);
         map.put(topicPartition, state);
+        if (prev == null)
             updateSize();
     }
 
     public void remove(TopicPartition topicPartition) {
-        map.remove(topicPartition);
+        if (map.remove(topicPartition) != null)
             updateSize();
     }
 
